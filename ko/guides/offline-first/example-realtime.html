
<!DOCTYPE HTML>
<html lang="ko" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Example realtime & publication · GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.2">
        
        
        
    
    <link rel="stylesheet" href="../../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-feathers-versions/plugin.css">
                
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
        <link rel="stylesheet" href="../../styles/website.css">
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="example-optimistic.html" />
    
    
    <link rel="prev" href="example-snapshot.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="검색어 입력" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../../">
            
                <a href="../../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../readme.html">
            
                <a href="../readme.html">
            
                    
                    Guides
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../about/readme.html">
            
                <a href="../about/readme.html">
            
                    
                    About Feathers
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1.1" data-path="../about/features.html">
            
                <a href="../about/features.html">
            
                    
                    Features
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.2" data-path="../about/philosophy.html">
            
                <a href="../about/philosophy.html">
            
                    
                    Philosophy
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.3" data-path="../about/vs.html">
            
                <a href="../about/vs.html">
            
                    
                    Feathers vs. X
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="../step-by-step/readme.html">
            
                <a href="../step-by-step/readme.html">
            
                    
                    The Basics
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.2.1" data-path="../step-by-step/intro/readme.html">
            
                <a href="../step-by-step/intro/readme.html">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.2" data-path="../step-by-step/intro/not-worry.html">
            
                <a href="../step-by-step/intro/not-worry.html">
            
                    
                    What not to worry about
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.3" data-path="../step-by-step/preliminaries.html">
            
                <a href="../step-by-step/preliminaries.html">
            
                    
                    Installing the Examples
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.4" data-path="../step-by-step/basic-feathers/readme.html">
            
                <a href="../step-by-step/basic-feathers/readme.html">
            
                    
                    Basic Feathers
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.5" data-path="../step-by-step/basic-feathers/database-connector.html">
            
                <a href="../step-by-step/basic-feathers/database-connector.html">
            
                    
                    A database connector
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.6" data-path="../step-by-step/basic-feathers/rest-api-server.html">
            
                <a href="../step-by-step/basic-feathers/rest-api-server.html">
            
                    
                    A REST API server
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.7" data-path="../step-by-step/basic-feathers/rest-client.html">
            
                <a href="../step-by-step/basic-feathers/rest-client.html">
            
                    
                    A Feathers REST client
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.8" data-path="../step-by-step/basic-feathers/socket-client.html">
            
                <a href="../step-by-step/basic-feathers/socket-client.html">
            
                    
                    A Feathers WebSocket client
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.9" data-path="../step-by-step/basic-feathers/a-ha.html">
            
                <a href="../step-by-step/basic-feathers/a-ha.html">
            
                    
                    The "a-ha!" moment
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.10" data-path="../step-by-step/basic-feathers/hooks-middleware.html">
            
                <a href="../step-by-step/basic-feathers/hooks-middleware.html">
            
                    
                    Hooks middleware
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.11" data-path="../step-by-step/basic-feathers/all-about-hooks.html">
            
                <a href="../step-by-step/basic-feathers/all-about-hooks.html">
            
                    
                    All about hooks
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.12" data-path="../step-by-step/basic-feathers/hooks-1.html">
            
                <a href="../step-by-step/basic-feathers/hooks-1.html">
            
                    
                    Hooks, part 1
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.13" data-path="../step-by-step/basic-feathers/hooks-2.html">
            
                <a href="../step-by-step/basic-feathers/hooks-2.html">
            
                    
                    Hooks, part 2
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.14" data-path="../step-by-step/basic-feathers/writing-hooks.html">
            
                <a href="../step-by-step/basic-feathers/writing-hooks.html">
            
                    
                    Writing your own hooks
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.15" data-path="../step-by-step/basic-feathers/testing-hooks.html">
            
                <a href="../step-by-step/basic-feathers/testing-hooks.html">
            
                    
                    Testing hooks
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.16" data-path="../step-by-step/basic-feathers/real-time.html">
            
                <a href="../step-by-step/basic-feathers/real-time.html">
            
                    
                    Real-time
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="../step-by-step/generators/readme.html">
            
                <a href="../step-by-step/generators/readme.html">
            
                    
                    The Generator (CLI)
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.3.1" data-path="../step-by-step/generators/gen-app.html">
            
                <a href="../step-by-step/generators/gen-app.html">
            
                    
                    Generate the application
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3.2" data-path="../step-by-step/generators/gen-authentication.html">
            
                <a href="../step-by-step/generators/gen-authentication.html">
            
                    
                    Add authentication
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3.3" data-path="../step-by-step/generators/gen-service.html">
            
                <a href="../step-by-step/generators/gen-service.html">
            
                    
                    Add the teams service
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3.4" data-path="../step-by-step/generators/gen-hook.html">
            
                <a href="../step-by-step/generators/gen-hook.html">
            
                    
                    Add the populate hook
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3.5" data-path="../step-by-step/generators/gen-run.html">
            
                <a href="../step-by-step/generators/gen-run.html">
            
                    
                    Run the application
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.4" data-path="../chat/readme.html">
            
                <a href="../chat/readme.html">
            
                    
                    A Chat Application
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.4.1" data-path="../chat/creating.html">
            
                <a href="../chat/creating.html">
            
                    
                    Creating the application
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4.2" data-path="../chat/service.html">
            
                <a href="../chat/service.html">
            
                    
                    Generating a service
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4.3" data-path="../chat/frontend.html">
            
                <a href="../chat/frontend.html">
            
                    
                    Building a frontend
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4.4" data-path="../chat/authentication.html">
            
                <a href="../chat/authentication.html">
            
                    
                    Adding authentication
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4.5" data-path="../chat/processing.html">
            
                <a href="../chat/processing.html">
            
                    
                    Processing data
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.5" data-path="../frameworks/readme.html">
            
                <a href="../frameworks/readme.html">
            
                    
                    Frameworks
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.5.1" >
            
                <span>
            
                    
                    React and React Native
            
                </span>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.5.2" >
            
                <span>
            
                    
                    VueJS
            
                </span>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.5.3" >
            
                <span>
            
                    
                    Angular
            
                </span>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.5.4" >
            
                <span>
            
                    
                    Others
            
                </span>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.6" data-path="../auth/readme.html">
            
                <a href="../auth/readme.html">
            
                    
                    Authentication
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.6.1" data-path="../auth/how-jwt-works.html">
            
                <a href="../auth/how-jwt-works.html">
            
                    
                    How JWT works
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.6.2" >
            
                <a target="_blank" href="https://github.com/feathersjs/feathers-authentication/blob/master/docs/new-1.0-features.md">
            
                    
                    What's New (external link)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.6.3" >
            
                <a target="_blank" href="https://github.com/feathersjs/feathers-authentication/blob/master/docs/migrating.md">
            
                    
                    Migration Guide (external link)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.6.4" data-path="../auth/recipe.customize-response.html">
            
                <a href="../auth/recipe.customize-response.html">
            
                    
                    Recipe: Custom Login Response
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.6.5" data-path="../auth/recipe.customize-jwt-payload.html">
            
                <a href="../auth/recipe.customize-jwt-payload.html">
            
                    
                    Recipe: Custom JWT Payload
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.6.6" data-path="../auth/recipe.mixed-auth.html">
            
                <a href="../auth/recipe.mixed-auth.html">
            
                    
                    Recipe: Mixed Auth Endpoints
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.6.7" data-path="../auth/recipe.oauth-basic.html">
            
                <a href="../auth/recipe.oauth-basic.html">
            
                    
                    Recipe: Basic OAuth
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.7" data-path="readme.html">
            
                <a href="readme.html">
            
                    
                    Offline first
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.7.1" data-path="strategies.html">
            
                <a href="strategies.html">
            
                    
                    Strategies
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.7.2" data-path="snapshot.html">
            
                <a href="snapshot.html">
            
                    
                    Snapshot
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.7.3" data-path="realtime.html">
            
                <a href="realtime.html">
            
                    
                    Realtime
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.7.4" data-path="optimistic-mutation.html">
            
                <a href="optimistic-mutation.html">
            
                    
                    Optimistic mutation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.7.5" data-path="owndata-ownnet.html">
            
                <a href="owndata-ownnet.html">
            
                    
                    Own-data, own-net
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.7.6" data-path="syncdata-syncnet.html">
            
                <a href="syncdata-syncnet.html">
            
                    
                    Sync-data, sync-net
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.7.7" data-path="configure-snapshot.html">
            
                <a href="configure-snapshot.html">
            
                    
                    Configure snapshot
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.7.8" data-path="configure-realtime.html">
            
                <a href="configure-realtime.html">
            
                    
                    Configure realtime
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.7.9" data-path="configure-publication.html">
            
                <a href="configure-publication.html">
            
                    
                    Configure publication
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.7.10" data-path="example-snapshot.html">
            
                <a href="example-snapshot.html">
            
                    
                    Example snapshot
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.2.7.11" data-path="example-realtime.html">
            
                <a href="example-realtime.html">
            
                    
                    Example realtime & publication
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.7.12" data-path="example-optimistic.html">
            
                <a href="example-optimistic.html">
            
                    
                    Example optimistic mutation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.7.13" data-path="example-tests.html">
            
                <a href="example-tests.html">
            
                    
                    Tests as examples
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.7.14" data-path="example-more.html">
            
                <a href="example-more.html">
            
                    
                    More examples
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.8" data-path="../advanced/readme.html">
            
                <a href="../advanced/readme.html">
            
                    
                    Advanced topics
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.8.1" data-path="../advanced/debugging.html">
            
                <a href="../advanced/debugging.html">
            
                    
                    Debugging
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.8.2" data-path="../advanced/configuration.html">
            
                <a href="../advanced/configuration.html">
            
                    
                    Configuration
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.8.3" data-path="../advanced/file-uploading.html">
            
                <a href="../advanced/file-uploading.html">
            
                    
                    File uploads
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.8.4" data-path="../advanced/creating-a-plugin.html">
            
                <a href="../advanced/creating-a-plugin.html">
            
                    
                    Creating a Feathers plugin
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.8.5" data-path="../advanced/seeding-services.html">
            
                <a href="../advanced/seeding-services.html">
            
                    
                    Seeding services
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.8.6" data-path="../advanced/using-a-view-engine.html">
            
                <a href="../advanced/using-a-view-engine.html">
            
                    
                    Using a view engine
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.8.7" data-path="../advanced/scaling.html">
            
                <a href="../advanced/scaling.html">
            
                    
                    Scaling
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../../api/readme.html">
            
                <a href="../../api/readme.html">
            
                    
                    API
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" >
            
                <span>
            
                    
                    Core
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1.1" data-path="../../api/application.html">
            
                <a href="../../api/application.html">
            
                    
                    Application
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.2" data-path="../../api/services.html">
            
                <a href="../../api/services.html">
            
                    
                    Services
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.3" data-path="../../api/hooks.html">
            
                <a href="../../api/hooks.html">
            
                    
                    Hooks
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.4" data-path="../../api/hooks-common.html">
            
                <a href="../../api/hooks-common.html">
            
                    
                    Common Hooks
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.5" data-path="../../api/client.html">
            
                <a href="../../api/client.html">
            
                    
                    Client
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.6" data-path="../../api/events.html">
            
                <a href="../../api/events.html">
            
                    
                    Events
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.7" data-path="../../api/errors.html">
            
                <a href="../../api/errors.html">
            
                    
                    Errors
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.2" >
            
                <span>
            
                    
                    Transports
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.2.1" data-path="../../api/rest.html">
            
                <a href="../../api/rest.html">
            
                    
                    REST
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.2" data-path="../../api/express.html">
            
                <a href="../../api/express.html">
            
                    
                    Express
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.3" data-path="../../api/socketio.html">
            
                <a href="../../api/socketio.html">
            
                    
                    Socket.io
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.4" data-path="../../api/primus.html">
            
                <a href="../../api/primus.html">
            
                    
                    Primus
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.3" >
            
                <span>
            
                    
                    Authentication
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.3.1" data-path="../../api/authentication/server.html">
            
                <a href="../../api/authentication/server.html">
            
                    
                    Server
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.2" data-path="../../api/authentication/client.html">
            
                <a href="../../api/authentication/client.html">
            
                    
                    Client
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.3" data-path="../../api/authentication/local.html">
            
                <a href="../../api/authentication/local.html">
            
                    
                    Local
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.4" data-path="../../api/authentication/local-management.html">
            
                <a href="../../api/authentication/local-management.html">
            
                    
                    Local management
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.5" data-path="../../api/authentication/jwt.html">
            
                <a href="../../api/authentication/jwt.html">
            
                    
                    JWT
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.6" data-path="../../api/authentication/oauth1.html">
            
                <a href="../../api/authentication/oauth1.html">
            
                    
                    OAuth1
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.7" data-path="../../api/authentication/oauth2.html">
            
                <a href="../../api/authentication/oauth2.html">
            
                    
                    OAuth2
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.8" data-path="../../api/authentication/hooks.html">
            
                <a href="../../api/authentication/hooks.html">
            
                    
                    Hooks
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.4" >
            
                <span>
            
                    
                    Databases
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.4.1" data-path="../../api/databases/common.html">
            
                <a href="../../api/databases/common.html">
            
                    
                    Common API
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4.2" data-path="../../api/databases/querying.html">
            
                <a href="../../api/databases/querying.html">
            
                    
                    Querying
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4.3" data-path="../../api/databases/memory.html">
            
                <a href="../../api/databases/memory.html">
            
                    
                    Memory
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4.4" data-path="../../api/databases/nedb.html">
            
                <a href="../../api/databases/nedb.html">
            
                    
                    NeDb
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4.5" data-path="../../api/databases/localstorage.html">
            
                <a href="../../api/databases/localstorage.html">
            
                    
                    LocalStorage
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4.6" data-path="../../api/databases/mongodb.html">
            
                <a href="../../api/databases/mongodb.html">
            
                    
                    MongoDB
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4.7" data-path="../../api/databases/mongoose.html">
            
                <a href="../../api/databases/mongoose.html">
            
                    
                    Mongoose
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4.8" data-path="../../api/databases/sequelize.html">
            
                <a href="../../api/databases/sequelize.html">
            
                    
                    Sequelize
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4.9" data-path="../../api/databases/knexjs.html">
            
                <a href="../../api/databases/knexjs.html">
            
                    
                    Knex
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4.10" data-path="../../api/databases/rethinkdb.html">
            
                <a href="../../api/databases/rethinkdb.html">
            
                    
                    RethinkDB
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4.11" data-path="../../api/databases/elasticsearch.html">
            
                <a href="../../api/databases/elasticsearch.html">
            
                    
                    Elasticsearch
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../../SECURITY.html">
            
                <a href="../../SECURITY.html">
            
                    
                    Security
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../../ecosystem/readme.html">
            
                <a href="../../ecosystem/readme.html">
            
                    
                    Ecosystem
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="../../help/readme.html">
            
                <a href="../../help/readme.html">
            
                    
                    Help
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="../../faq/readme.html">
            
                <a href="../../faq/readme.html">
            
                    
                    FAQ
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="../../contributing/readme.html">
            
                <a href="../../contributing/readme.html">
            
                    
                    Contributing
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="../../license.md">
            
                <span>
            
                    
                    License
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            GitBook에 게시
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../.." >Example realtime & publication</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="examples-of-realtime-replication">Examples of realtime replication</h1>
<p>Realtime starts with a snapshot of the remote service data.
Subsequent data changes made at the remote are delivered to the client as they occur in near real time.
The data changes are applied at the client in the same order as they occurred at the remote.</p>
<p>Replication stops when communication is lost with the server.
It can be restarted on reconnection.</p>
<h2 id="example-1---all-the-remote-service-data"><strong>Example 1</strong> - All the remote service data</h2>
<h4 id="running-the-example">Running the example</h4>
<blockquote>
<p>Let&apos;s see how mutations made on the server are handled by realtime replication,
along with disconnections and reconnections.</p>
</blockquote>
<p>You can run this example with:</p>
<pre><code class="lang-text">cd path/to/feathers-mobile/examples
npm install
cd ./realtime-1
npm run build
npm start
</code></pre>
<p>Then point a browser at <code>localhost:3030</code>
and look at the log on the browser console.</p>
<p>You can see the client source
<a href="https://github.com/feathersjs/feathers-docs/blob/master/examples/offline/realtime-1/client/index.js" target="_blank">here</a>,
<a href="https://github.com/feathersjs/feathers-docs/blob/master/examples/offline/realtime-1/client/1-third-party.js" target="_blank">here</a>
and <a href="https://github.com/feathersjs/feathers-docs/blob/master/examples/offline/realtime-1/client/2-reconnect.js" target="_blank">here</a>.</p>
<h4 id="looking-at-the-log">Looking at the log</h4>
<p>Configure the replication and start it:</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">import</span> Realtime <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;feathers-offline-realtime&apos;</span>;
<span class="hljs-keyword">const</span> stockRemote = feathersApp.service(<span class="hljs-string">&apos;/stock&apos;</span>);

<span class="hljs-keyword">const</span> stockRealtime = <span class="hljs-keyword">new</span> Realtime(stockRemote);

stockRealtime.connect().then( ... );
</code></pre>
<p>A snapshot of the remote service data is sent to the client when replication starts.</p>
<pre><code class="lang-text">===== stockRemote, before mutations
{dept: &quot;a&quot;, stock: &quot;a1&quot;, _id: &quot;fY6ezNH9Rlw2WVzX&quot;}
{dept: &quot;a&quot;, stock: &quot;a2&quot;, _id: &quot;7a0b00diX18WO3Gm&quot;}
{dept: &quot;a&quot;, stock: &quot;a3&quot;, _id: &quot;b2wVdYJeiCNTGLc6&quot;}
{dept: &quot;a&quot;, stock: &quot;a4&quot;, _id: &quot;wtTVYE15plCOb2vW&quot;}
{dept: &quot;a&quot;, stock: &quot;a5&quot;, _id: &quot;cnWD1Yzr8WJruOfi&quot;}
</code></pre>
<pre><code class="lang-javascript">stockRealtime.store.records.forEach(record =&gt; <span class="hljs-built_in">console</span>.log(record))
</code></pre>
<pre><code class="lang-text">===== client replica, before mutations
{dept: &quot;a&quot;, stock: &quot;a2&quot;, _id: &quot;7a0b00diX18WO3Gm&quot;}
{dept: &quot;a&quot;, stock: &quot;a3&quot;, _id: &quot;b2wVdYJeiCNTGLc6&quot;}
{dept: &quot;a&quot;, stock: &quot;a5&quot;, _id: &quot;cnWD1Yzr8WJruOfi&quot;}
{dept: &quot;a&quot;, stock: &quot;a1&quot;, _id: &quot;fY6ezNH9Rlw2WVzX&quot;}
{dept: &quot;a&quot;, stock: &quot;a4&quot;, _id: &quot;wtTVYE15plCOb2vW&quot;}
</code></pre>
<p>We can simulate other people changing data on the remote service.</p>
<pre><code class="lang-text">===== mutate stockRemote
stockRemote.patch stock: a1
stockRemote.create stock: a99
stockRemote.remove stock: a2
</code></pre>
<p>The mutations are replicated to the client.</p>
<pre><code class="lang-text">===== stockRemote, after mutations
{dept: &quot;a&quot;, stock: &quot;a1&quot;, _id: &quot;fY6ezNH9Rlw2WVzX&quot;, foo: 1}
{dept: &quot;a&quot;, stock: &quot;a3&quot;, _id: &quot;b2wVdYJeiCNTGLc6&quot;}
{dept: &quot;a&quot;, stock: &quot;a4&quot;, _id: &quot;wtTVYE15plCOb2vW&quot;}
{dept: &quot;a&quot;, stock: &quot;a5&quot;, _id: &quot;cnWD1Yzr8WJruOfi&quot;}
{dept: &quot;a&quot;, stock: &quot;a99&quot;, _id: &quot;Yiu8R0fHQkEaGjPz&quot;}
===== client replica, after mutations
{dept: &quot;a&quot;, stock: &quot;a3&quot;, _id: &quot;b2wVdYJeiCNTGLc6&quot;}
{dept: &quot;a&quot;, stock: &quot;a5&quot;, _id: &quot;cnWD1Yzr8WJruOfi&quot;}
{dept: &quot;a&quot;, stock: &quot;a4&quot;, _id: &quot;wtTVYE15plCOb2vW&quot;}
{dept: &quot;a&quot;, stock: &quot;a1&quot;, _id: &quot;fY6ezNH9Rlw2WVzX&quot;, foo: 1}
{dept: &quot;a&quot;, stock: &quot;a99&quot;, _id: &quot;Yiu8R0fHQkEaGjPz&quot;}
</code></pre>
<p>We can inform the replicator of a lost connection, after which other people mutate more data.</p>
<pre><code class="lang-javascript">stockRealtime.disconnect();
</code></pre>
<pre><code class="lang-text">&gt;&gt;&gt;&gt;&gt; disconnection from server
===== mutate stockRemote
stockRemote.patch stock: a3
stockRemote.create stock: a98
stockRemote.remove stock: a5
</code></pre>
<p>After we inform the replicator of a reconnection,
the client replica is brought up to data with a new snapshot.</p>
<pre><code class="lang-javascript">stockRealtime.connect();
</code></pre>
<pre><code class="lang-text">&lt;&lt;&lt;&lt;&lt; reconnected to server
===== stockRemote, after reconnection
{dept: &quot;a&quot;, stock: &quot;a1&quot;, _id: &quot;fY6ezNH9Rlw2WVzX&quot;, foo: 1}
{dept: &quot;a&quot;, stock: &quot;a3&quot;, _id: &quot;b2wVdYJeiCNTGLc6&quot;, foo: 1}
{dept: &quot;a&quot;, stock: &quot;a4&quot;, _id: &quot;wtTVYE15plCOb2vW&quot;}
{dept: &quot;a&quot;, stock: &quot;a98&quot;, _id: &quot;XCZorVYjeHBlwz93&quot;}
{dept: &quot;a&quot;, stock: &quot;a99&quot;, _id: &quot;Yiu8R0fHQkEaGjPz&quot;}
===== client replica, after reconnection
{dept: &quot;a&quot;, stock: &quot;a98&quot;, _id: &quot;XCZorVYjeHBlwz93&quot;}
{dept: &quot;a&quot;, stock: &quot;a99&quot;, _id: &quot;Yiu8R0fHQkEaGjPz&quot;}
{dept: &quot;a&quot;, stock: &quot;a3&quot;, _id: &quot;b2wVdYJeiCNTGLc6&quot;, foo: 1}
{dept: &quot;a&quot;, stock: &quot;a1&quot;, _id: &quot;fY6ezNH9Rlw2WVzX&quot;, foo: 1}
{dept: &quot;a&quot;, stock: &quot;a4&quot;, _id: &quot;wtTVYE15plCOb2vW&quot;}
===== Example finished.
</code></pre>
<hr>
<h2 id="example-2---selected-remote-service-data"><strong>Example 2</strong> - Selected remote service data</h2>
<h4 id="running-the-example">Running the example</h4>
<blockquote>
<p>Let&apos;s see how a filter function (not a &quot;publication&quot;)
allows you to replicate a selection of the remote service data.</p>
<p>All service events are sent to the client as no &quot;publication&quot; is used</p>
</blockquote>
<p>You can run this example with:</p>
<pre><code class="lang-text">cd path/to/feathers-mobile/examples
npm install
cd ./realtime-2
npm run build
npm start
</code></pre>
<p>Then point a browser at <code>localhost:3030</code>
and look at the log on the browser console.</p>
<p>You can see the client source
<a href="https://github.com/feathersjs/feathers-docs/blob/master/examples/offline/realtime-2/client/index.js" target="_blank">here</a>,
and <a href="https://github.com/feathersjs/feathers-docs/blob/master/examples/offline/realtime-2/client/1-third-party.js" target="_blank">here</a>.</p>
<h4 id="looking-at-the-log">Looking at the log</h4>
<p>The client replica will contain those records with <code>record.dept === &apos;a&apos;</code>.
All service events are sent to the client because a filter function is used,
not a &quot;publication&quot;.
Filter functions run on the client only,
while a &quot;publication&quot; runs both on the server (to minimize the service events sent the client)
and on the client.</p>
<p>Configure the replication and start it:</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">import</span> Realtime <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;feathers-offline-realtime&apos;</span>;

<span class="hljs-keyword">const</span> stockRemote = feathersApp.service(<span class="hljs-string">&apos;/stock&apos;</span>);
stockRemote.on(<span class="hljs-string">&apos;patched&apos;</span>, record =&gt; <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`.service event. patched`</span>, record));

<span class="hljs-keyword">const</span> stockRealtime = <span class="hljs-keyword">new</span> Realtime(stockRemote, {
  publication: record =&gt; record.dept === <span class="hljs-string">&apos;a&apos;</span>, <span class="hljs-comment">// this is a filter func, not a &quot;publication&quot;</span>
  sort: Realtime.sort(<span class="hljs-string">&apos;stock&apos;</span>), <span class="hljs-comment">// sort the client replica</span>
  query: { dept: <span class="hljs-string">&apos;a&apos;</span> },         <span class="hljs-comment">// makes snapshots more efficient</span>
  subscriber                    <span class="hljs-comment">// logs replicator events</span>
});

stockRealtime.connect().then( ... );

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">subscriber</span>(<span class="hljs-params">records, { action, eventName, source }</span>) </span>{
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`.replicator event. action=<span class="hljs-subst">${action}</span> eventName=<span class="hljs-subst">${eventName}</span> source=<span class="hljs-subst">${source}</span>`</span>);
}
</code></pre>
<p>A snapshot of part of the remote service data is sent to the client when replication starts.</p>
<pre><code class="lang-text">.replicator event. action=snapshot eventName=undefined source=undefined undefined
.replicator event. action=add-listeners eventName=undefined source=undefined undefined
===== stockRemote, before mutations
{dept: &quot;a&quot;, stock: &quot;a1&quot;, _id: &quot;lwKU5HpWnumm51wK&quot;}
{dept: &quot;a&quot;, stock: &quot;a2&quot;, _id: &quot;xC2ZVq6xaUpJOBgb&quot;}
{dept: &quot;a&quot;, stock: &quot;a3&quot;, _id: &quot;Z0Y16Pn8d3RA7rXU&quot;}
{dept: &quot;a&quot;, stock: &quot;a4&quot;, _id: &quot;kfWCtTo1p2cpN9oN&quot;}
{dept: &quot;a&quot;, stock: &quot;a5&quot;, _id: &quot;JxlD78JV6S5uZHvD&quot;}
{dept: &quot;b&quot;, stock: &quot;b1&quot;, _id: &quot;meldJsoQSM80mSJM&quot;}
{dept: &quot;b&quot;, stock: &quot;b2&quot;, _id: &quot;iujwY33XVFIjLm0U&quot;}
{dept: &quot;b&quot;, stock: &quot;b3&quot;, _id: &quot;Pws5I5A8a3dC7yyJ&quot;}
{dept: &quot;b&quot;, stock: &quot;b4&quot;, _id: &quot;n4R9UxQQxR4HMbFi&quot;}
{dept: &quot;b&quot;, stock: &quot;b5&quot;, _id: &quot;lpFPGhIInYba698P&quot;}
</code></pre>
<pre><code class="lang-javascript">stockRealtime.store.records.forEach(record =&gt; <span class="hljs-built_in">console</span>.log(record))
</code></pre>
<pre><code class="lang-text">===== client replica of dept: a, before mutations
{dept: &quot;a&quot;, stock: &quot;a1&quot;, _id: &quot;lwKU5HpWnumm51wK&quot;}
{dept: &quot;a&quot;, stock: &quot;a2&quot;, _id: &quot;xC2ZVq6xaUpJOBgb&quot;}
{dept: &quot;a&quot;, stock: &quot;a3&quot;, _id: &quot;Z0Y16Pn8d3RA7rXU&quot;}
{dept: &quot;a&quot;, stock: &quot;a4&quot;, _id: &quot;kfWCtTo1p2cpN9oN&quot;}
{dept: &quot;a&quot;, stock: &quot;a5&quot;, _id: &quot;JxlD78JV6S5uZHvD&quot;}
</code></pre>
<p>We can simulate other people changing data on the remote service.</p>
<pre><code class="lang-text">===== mutate stockRemote
stockRemote.patch stock: a1 move to dept: b
stockRemote.patch stock: b1 move to dept: a
.service event. patched
    {dept: &quot;b&quot;, stock: &quot;a1&quot;, _id: &quot;raBDpgjM4ilKa0PX&quot;}
.replicator event. action=left-pub eventName=patched source=0
    {dept: &quot;b&quot;, stock: &quot;a1&quot;, _id: &quot;raBDpgjM4ilKa0PX&quot;}
.service event. patched
    {dept: &quot;a&quot;, stock: &quot;b1&quot;, _id: &quot;RKbbo7EgaAeWqqnu&quot;}
.replicator event. action=mutated eventName=patched source=0
    {dept: &quot;a&quot;, stock: &quot;b1&quot;, _id: &quot;RKbbo7EgaAeWqqnu&quot;}
===== patch some stockRemote records without changing their contents
.service event. patched
    {dept: &quot;a&quot;, stock: &quot;a2&quot;, _id: &quot;r9VPWIdwZsYNEAvI&quot;}
.replicator event. action=mutated eventName=patched source=0
    {dept: &quot;a&quot;, stock: &quot;a2&quot;, _id: &quot;r9VPWIdwZsYNEAvI&quot;}
.service event. patched
    {dept: &quot;a&quot;, stock: &quot;a3&quot;, _id: &quot;n66vXg1lBuh3XX4O&quot;}
.replicator event. action=mutated eventName=patched source=0
    {dept: &quot;a&quot;, stock: &quot;a3&quot;, _id: &quot;n66vXg1lBuh3XX4O&quot;}
.service event. patched
    {dept: &quot;b&quot;, stock: &quot;b2&quot;, _id: &quot;77rLKbncUcxOFHJM&quot;}
.service event. patched
    {dept: &quot;b&quot;, stock: &quot;b3&quot;, _id: &quot;1IIQqVn8TYcopdzl&quot;}
.service event. patched
    {dept: &quot;b&quot;, stock: &quot;b4&quot;, _id: &quot;rSfCl9WXfTi7oa6N&quot;}
.service event. patched
    {dept: &quot;b&quot;, stock: &quot;b5&quot;, _id: &quot;LqXhzpPLidkIVGuG&quot;}
</code></pre>
<p>Notice that the last 4 service events were not relevant to our publication filter
and so no replication events occurred for them.
<strong>There was no need to send these 4 service events to the client.</strong></p>
<p>The mutations are replicated to the client.</p>
<pre><code class="lang-text">===== stockRemote, after mutations
{dept: &quot;b&quot;, stock: &quot;a1&quot;, _id: &quot;lwKU5HpWnumm51wK&quot;}
{dept: &quot;a&quot;, stock: &quot;a2&quot;, _id: &quot;xC2ZVq6xaUpJOBgb&quot;}
{dept: &quot;a&quot;, stock: &quot;a3&quot;, _id: &quot;Z0Y16Pn8d3RA7rXU&quot;}
{dept: &quot;a&quot;, stock: &quot;a4&quot;, _id: &quot;kfWCtTo1p2cpN9oN&quot;}
{dept: &quot;a&quot;, stock: &quot;a5&quot;, _id: &quot;JxlD78JV6S5uZHvD&quot;}
{dept: &quot;a&quot;, stock: &quot;b1&quot;, _id: &quot;meldJsoQSM80mSJM&quot;}
{dept: &quot;b&quot;, stock: &quot;b2&quot;, _id: &quot;iujwY33XVFIjLm0U&quot;}
{dept: &quot;b&quot;, stock: &quot;b3&quot;, _id: &quot;Pws5I5A8a3dC7yyJ&quot;}
{dept: &quot;b&quot;, stock: &quot;b4&quot;, _id: &quot;n4R9UxQQxR4HMbFi&quot;}
{dept: &quot;b&quot;, stock: &quot;b5&quot;, _id: &quot;lpFPGhIInYba698P&quot;}
===== client replica of dept a, after mutations
{dept: &quot;a&quot;, stock: &quot;a2&quot;, _id: &quot;xC2ZVq6xaUpJOBgb&quot;}
{dept: &quot;a&quot;, stock: &quot;a3&quot;, _id: &quot;Z0Y16Pn8d3RA7rXU&quot;}
{dept: &quot;a&quot;, stock: &quot;a4&quot;, _id: &quot;kfWCtTo1p2cpN9oN&quot;}
{dept: &quot;a&quot;, stock: &quot;a5&quot;, _id: &quot;JxlD78JV6S5uZHvD&quot;}
{dept: &quot;a&quot;, stock: &quot;b1&quot;, _id: &quot;meldJsoQSM80mSJM&quot;}
===== Example finished.
</code></pre>
<p>The <code>stock: &apos;a1&apos;</code> record was removed from the client replica because it no longer satisfied
the publication filter after mutation.
The <code>stock: &apos;b1&apos;</code> record was added
as its mutation caused it to now satisfied the publication filter.</p>
<hr>
<h2 id="example-3---using-a-publication"><strong>Example 3</strong> - Using a publication</h2>
<blockquote>
<p>Let&apos;s redo Example 2 using a &quot;publication&quot; rather than a filter function.
We expect the &quot;publication&quot; to minimize the number of service events sent to the client.</p>
</blockquote>
<h4 id="running-the-example">Running the example</h4>
<p>You can run this example with:</p>
<pre><code class="lang-text">cd path/to/feathers-mobile/examples
npm install
cd ./realtime-3
npm run build
npm start
</code></pre>
<p>Then point a browser at <code>localhost:3030</code>
and look at the log on the browser console.</p>
<p>You can see the key server source
<a href="https://github.com/feathersjs/feathers-docs/blob/master/examples/offline/realtime-3/src/index.js" target="_blank">here</a>.</p>
<p>You can see the client source
<a href="https://github.com/feathersjs/feathers-docs/blob/master/examples/offline/realtime-3/client/index.js" target="_blank">here</a>,
and <a href="https://github.com/feathersjs/feathers-docs/blob/master/examples/offline/realtime-3/client/1-third-party.js" target="_blank">here</a>.</p>
<h4 id="the-key-server-code">The key server code</h4>
<pre><code class="lang-javascript"><span class="hljs-keyword">const</span> serverPublication = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;feathers-offline-publication/lib/server&apos;</span>);
<span class="hljs-keyword">const</span> commonPublications = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;feathers-offline-publication/lib/common-publications&apos;</span>);
<span class="hljs-keyword">const</span> { stashBefore } = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;feathers-hooks-common&apos;</span>);

<span class="hljs-keyword">const</span> port = app.get(<span class="hljs-string">&apos;port&apos;</span>);
<span class="hljs-keyword">const</span> server = app.listen(port);

<span class="hljs-keyword">const</span> stockRemote = app.service(<span class="hljs-string">&apos;stock&apos;</span>);
stockRemote.hooks({
  before: {
    update: stashBefore(),
    patch: stashBefore(),
    remove: stashBefore(),
  },
});

serverPublication(app, commonPublications, <span class="hljs-string">&apos;stock&apos;</span>);
</code></pre>
<p>The <code>stashBefore</code> hooks will stash the current value of the record into <code>context.params</code>
before the record is mutated.
The service filter will use the stashed value to check if the record used to belong to the publication.</p>
<p>The <code>serverPublication</code> call configures the service filters,
in this case for the stock service.
You can use syntax like <code>[&apos;messages&apos;, &apos;comments&apos;]</code> to configure multiple services at once.</p>
<blockquote>
<p><strong>ProTip:</strong> <code>serverPublication</code> must be run only after the server has started listening.</p>
</blockquote>
<h4 id="the-key-client-code">The key client code</h4>
<pre><code class="lang-javascript"><span class="hljs-keyword">const</span> clientPublication = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;feathers-offline-publication/lib/client&apos;</span>);
<span class="hljs-keyword">const</span> commonPublications = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;feathers-offline-publication/lib/common-publications&apos;</span>);
<span class="hljs-keyword">const</span> Realtime = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;feathers-offline-realtime&apos;</span>);

<span class="hljs-keyword">const</span> stockRemote = feathersApp.service(<span class="hljs-string">&apos;/stock&apos;</span>);

<span class="hljs-keyword">const</span> stockRealtime = <span class="hljs-keyword">new</span> Realtime(stockRemote, {
  publication: clientPublication.addPublication(feathersApp, <span class="hljs-string">&apos;stock&apos;</span>, {
    <span class="hljs-built_in">module</span>: commonPublications,
    name: <span class="hljs-string">&apos;query&apos;</span>,
    params: { dept: <span class="hljs-string">&apos;a&apos;</span> },
  }),
});

stockRealtime.connect().then( ... );
</code></pre>
<p>The <code>publication</code> option is now a &quot;publication&quot; rather than a filter function.
The <code>addPublication</code> emits the <code>name</code> and <code>params</code> values to the server,
while returning a filter function as the actual value for <code>publication</code>.
The server will start using <code>name</code> and <code>params</code> in the server-side service filters.</p>
<h4 id="looking-at-the-log">Looking at the log</h4>
<p>The previous example #2 log contained</p>
<pre><code class="lang-text">===== mutate stockRemote
stockRemote.patch stock: a1 move to dept: b
stockRemote.patch stock: b1 move to dept: a
.service event. patched
    {dept: &quot;b&quot;, stock: &quot;a1&quot;, _id: &quot;raBDpgjM4ilKa0PX&quot;}
.replicator event. action=left-pub eventName=patched source=0
    {dept: &quot;b&quot;, stock: &quot;a1&quot;, _id: &quot;raBDpgjM4ilKa0PX&quot;}
.service event. patched
    {dept: &quot;a&quot;, stock: &quot;b1&quot;, _id: &quot;RKbbo7EgaAeWqqnu&quot;}
.replicator event. action=mutated eventName=patched source=0
    {dept: &quot;a&quot;, stock: &quot;b1&quot;, _id: &quot;RKbbo7EgaAeWqqnu&quot;}
===== patch some stockRemote records without changing their contents
.service event. patched
    {dept: &quot;a&quot;, stock: &quot;a2&quot;, _id: &quot;r9VPWIdwZsYNEAvI&quot;}
.replicator event. action=mutated eventName=patched source=0
    {dept: &quot;a&quot;, stock: &quot;a2&quot;, _id: &quot;r9VPWIdwZsYNEAvI&quot;}
.service event. patched
    {dept: &quot;a&quot;, stock: &quot;a3&quot;, _id: &quot;n66vXg1lBuh3XX4O&quot;}
.replicator event. action=mutated eventName=patched source=0
    {dept: &quot;a&quot;, stock: &quot;a3&quot;, _id: &quot;n66vXg1lBuh3XX4O&quot;}
.service event. patched
    {dept: &quot;b&quot;, stock: &quot;b2&quot;, _id: &quot;77rLKbncUcxOFHJM&quot;}
.service event. patched
    {dept: &quot;b&quot;, stock: &quot;b3&quot;, _id: &quot;1IIQqVn8TYcopdzl&quot;}
.service event. patched
    {dept: &quot;b&quot;, stock: &quot;b4&quot;, _id: &quot;rSfCl9WXfTi7oa6N&quot;}
.service event. patched
    {dept: &quot;b&quot;, stock: &quot;b5&quot;, _id: &quot;LqXhzpPLidkIVGuG&quot;}
</code></pre>
<p>We pointed out that the last 4 service events were not relevant to example #2&apos;s publication filter
and so no replication events occurred for them.
We also pointed out that <strong>there was no need to send these 4 service events to the client.</strong></p>
<p>Our example #3 log contains</p>
<pre><code class="lang-text">===== mutate stockRemote
stockRemote.patch stock: a1 move to dept: b
stockRemote.patch stock: b1 move to dept: a
.service event. patched
    {dept: &quot;b&quot;, stock: &quot;a1&quot;, _id: &quot;qR5KkXAP0TAdCXBm&quot;}
.replicator event. action=left-pub eventName=patched source=0
    {dept: &quot;b&quot;, stock: &quot;a1&quot;, _id: &quot;qR5KkXAP0TAdCXBm&quot;}
.service event. patched
    {dept: &quot;a&quot;, stock: &quot;b1&quot;, _id: &quot;LDtB9YvbJTHpOau2&quot;}
.replicator event. action=mutated eventName=patched source=0
    {dept: &quot;a&quot;, stock: &quot;b1&quot;, _id: &quot;LDtB9YvbJTHpOau2&quot;}
===== patch some stockRemote records without changing their contents
.service event. patched
    {dept: &quot;a&quot;, stock: &quot;a2&quot;, _id: &quot;fmMfWefDVeu9qrRt&quot;}
.replicator event. action=mutated eventName=patched source=0
    {dept: &quot;a&quot;, stock: &quot;a2&quot;, _id: &quot;fmMfWefDVeu9qrRt&quot;}
.service event. patched
    {dept: &quot;a&quot;, stock: &quot;a3&quot;, _id: &quot;WULt4o6N69G9x0Vf&quot;}
.replicator event. action=mutated eventName=patched source=0
    {dept: &quot;a&quot;, stock: &quot;a3&quot;, _id: &quot;WULt4o6N69G9x0Vf&quot;}
</code></pre>
<p>The example #3 does not contain the last 4 <code>.service event</code> entries.
<strong>The server-side service filters recognized those mutations were not relevant to our publication
and did not emit them to the client.</strong></p>
<p>Job done!</p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="example-snapshot.html" class="navigation navigation-prev " aria-label="Previous page: Example snapshot">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="example-optimistic.html" class="navigation navigation-next " aria-label="Next page: Example optimistic mutation">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Example realtime & publication","level":"1.2.7.11","depth":3,"next":{"title":"Example optimistic mutation","level":"1.2.7.12","depth":3,"path":"guides/offline-first/example-optimistic.md","ref":"guides/offline-first/example-optimistic.md","articles":[]},"previous":{"title":"Example snapshot","level":"1.2.7.10","depth":3,"path":"guides/offline-first/example-snapshot.md","ref":"guides/offline-first/example-snapshot.md","articles":[]},"dir":"ltr"},"config":{"plugins":["feathers-collapsible-menu","heading-anchors","include-codeblock","edit-link","ga","feathers-versions"],"styles":{"website":"styles/website.css"},"pluginsConfig":{"search":{},"lunr":{"maxIndexSize":1000000000,"ignoreSpecialCharacters":false},"fontsettings":{"theme":"white","family":"sans","size":2},"heading-anchors":{},"highlight":{},"feathers-versions":{},"ga":{"configuration":"auto","token":"UA-64904930-1"},"versions":{"gitbookConfigURL":"https://raw.githubusercontent.com/feathersjs/feathers-docs/master/book.json","options":[{"value":"https://docs.feathersjs.com","text":"Latest Stable (Auk)"},{"value":"https://legacy.docs.feathersjs.com","text":"Legacy (Pre-Auk)"}]},"include-codeblock":{"check":false,"edit":false,"fixlang":false,"lang":"","template":"default","theme":"chrome","unindent":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"edit-link":{"label":"Edit This Page","placement":"left","base":"https://github.com/feathersjs/feathers-docs/edit/master"},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false},"feathers-collapsible-menu":{}},"theme":"default","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"language":"ko","gitbook":"*"},"file":{"path":"guides/offline-first/example-realtime.md","mtime":"2017-07-07T07:10:07.000Z","type":"markdown"},"gitbook":{"version":"3.2.2","time":"2017-07-08T04:59:22.333Z"},"basePath":"../..","book":{"language":"ko"}});
        });
    </script>
</div>

        
    <script src="../../../gitbook/gitbook.js"></script>
    <script src="../../../gitbook/theme.js"></script>
    
        
        <script src="../../../gitbook/gitbook-plugin-feathers-collapsible-menu/plugin.js"></script>
        
    
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/1.2.1/anchor.min.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-heading-anchors/anchor-style.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-edit-link/plugin.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-ga/plugin.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-feathers-versions/plugin.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

